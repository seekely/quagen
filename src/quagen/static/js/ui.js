var ui=function(t){"use strict";function e(){}function n(t,e){for(const n in e)t[n]=e[n];return t}function o(t){return t()}function i(){return Object.create(null)}function r(t){t.forEach(o)}function s(t){return"function"==typeof t}function l(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let c,d=!1;function a(t,e,n,o){for(;t<e;){const i=t+(e-t>>1);n(i)<=o?t=i+1:e=i}return t}function u(t,e){d?(!function(t){if(t.hydrate_init)return;t.hydrate_init=!0;const e=t.childNodes,n=new Int32Array(e.length+1),o=new Int32Array(e.length);n[0]=-1;let i=0;for(let t=0;t<e.length;t++){const r=a(1,i+1,t=>e[n[t]].claim_order,e[t].claim_order)-1;o[t]=n[r]+1;const s=r+1;n[s]=t,i=Math.max(s,i)}const r=[],s=[];let l=e.length-1;for(let t=n[i]+1;0!=t;t=o[t-1]){for(r.push(e[t-1]);l>=t;l--)s.push(e[l]);l--}for(;l>=0;l--)s.push(e[l]);r.reverse(),s.sort((t,e)=>t.claim_order-e.claim_order);for(let e=0,n=0;e<s.length;e++){for(;n<r.length&&s[e].claim_order>=r[n].claim_order;)n++;const o=n<r.length?r[n]:null;t.insertBefore(s[e],o)}}(t),(void 0===t.actual_end_child||null!==t.actual_end_child&&t.actual_end_child.parentElement!==t)&&(t.actual_end_child=t.firstChild),e!==t.actual_end_child?t.insertBefore(e,t.actual_end_child):t.actual_end_child=e.nextSibling):e.parentNode!==t&&t.appendChild(e)}function f(t,e,n){d&&!n?u(t,e):(e.parentNode!==t||n&&e.nextSibling!==n)&&t.insertBefore(e,n||null)}function p(t){t.parentNode.removeChild(t)}function m(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function h(t){return document.createElement(t)}function g(t){return document.createTextNode(t)}function v(){return g(" ")}function y(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function $(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function b(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function x(t,e,n,o){t.style.setProperty(e,n,o?"important":"")}function w(t,e,n){t.classList[n?"add":"remove"](e)}function _(t){c=t}function k(){const t=function(){if(!c)throw new Error("Function called outside component initialization");return c}();return(e,n)=>{const o=t.$$.callbacks[e];if(o){const i=function(t,e){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}(e,n);o.slice().forEach(e=>{e.call(t,i)})}}}function C(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach(t=>t.call(this,e))}const j=[],M=[],S=[],I=[],z=Promise.resolve();let E=!1;function H(t){S.push(t)}let O=!1;const P=new Set;function B(){if(!O){O=!0;do{for(let t=0;t<j.length;t+=1){const e=j[t];_(e),T(e.$$)}for(_(null),j.length=0;M.length;)M.pop()();for(let t=0;t<S.length;t+=1){const e=S[t];P.has(e)||(P.add(e),e())}S.length=0}while(j.length);for(;I.length;)I.pop()();E=!1,O=!1,P.clear()}}function T(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(H)}}const A=new Set;let L;function N(){L={r:0,c:[],p:L}}function Y(){L.r||r(L.c),L=L.p}function F(t,e){t&&t.i&&(A.delete(t),t.i(e))}function U(t,e,n,o){if(t&&t.o){if(A.has(t))return;A.add(t),L.c.push(()=>{A.delete(t),o&&(n&&t.d(1),o())}),t.o(e)}}const X="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function V(t,e){const n={},o={},i={$$scope:1};let r=t.length;for(;r--;){const s=t[r],l=e[r];if(l){for(const t in s)t in l||(o[t]=1);for(const t in l)i[t]||(n[t]=l[t],i[t]=1);t[r]=l}else for(const t in s)i[t]=1}for(const t in o)t in n||(n[t]=void 0);return n}function R(t){return"object"==typeof t&&null!==t?t:{}}function q(t){t&&t.c()}function D(t,e,n,i){const{fragment:l,on_mount:c,on_destroy:d,after_update:a}=t.$$;l&&l.m(e,n),i||H(()=>{const e=c.map(o).filter(s);d?d.push(...e):r(e),t.$$.on_mount=[]}),a.forEach(H)}function G(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function J(t,e){-1===t.$$.dirty[0]&&(j.push(t),E||(E=!0,z.then(B)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function K(t,n,o,s,l,a,u=[-1]){const f=c;_(t);const m=t.$$={fragment:null,ctx:null,props:a,update:e,not_equal:l,bound:i(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(f?f.$$.context:n.context||[]),callbacks:i(),dirty:u,skip_bound:!1};let h=!1;if(m.ctx=o?o(t,n.props||{},(e,n,...o)=>{const i=o.length?o[0]:n;return m.ctx&&l(m.ctx[e],m.ctx[e]=i)&&(!m.skip_bound&&m.bound[e]&&m.bound[e](i),h&&J(t,e)),n}):[],m.update(),h=!0,r(m.before_update),m.fragment=!!s&&s(m.ctx),n.target){if(n.hydrate){d=!0;const t=function(t){return Array.from(t.childNodes)}(n.target);m.fragment&&m.fragment.l(t),t.forEach(p)}else m.fragment&&m.fragment.c();n.intro&&F(t.$$.fragment),D(t,n.target,n.anchor,n.customElement),d=!1,B()}_(f)}class Q{$destroy(){G(this,1),this.$destroy=e}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}class W{constructor(t){this.gameId=t,this.playerId=null,this.init=!1,this.completed=!1,this.moveHistory=[],this.moveLast=[],this.players={},this.scores=[],this.settings={},this.spotsCurrent=[],this.spotsProjected=[],this.turnCompleted=0,this.turnMoves={},this.timeCompleted=null,this.timeCreated=0,this.timeStarted=null,this.timeUpdated=0}update(t){this.completed="completed"in t?t.completed:this.completed,this.playerId="player_id"in t?t.player_id:this.playerId,this.players="players"in t?t.players:this.players,this.scores="scores"in t?t.scores:this.scores,this.settings="settings"in t?t.settings:this.settings,this.spotsCurrent="board"in t?t.board:this.spotsCurrent,this.spotsProjected="projected"in t?t.projected:this.spotsProjected,this.turnCompleted="turn_completed"in t?t.turn_completed:this.turnCompleted,this.turnMoves="turn_moves"in t?t.turn_moves:this.turnMoves,this.timeCompleted="time_completed"in t?t.time_completed:this.timeCompleted,this.timeCreated="time_created"in t?t.time_created:this.timeCreated,this.timeStarted="time_started"in t?t.time_started:this.timeStarted,this.timeUpdated="time_updated"in t?t.time_updated:this.timeUpdated,this.moveHistory="history"in t?t.history:this.moveHistory,0<this.moveHistory.length&&(this.moveLast=this.moveHistory.slice(-1)[0]),this.init=!0}getSetting(t){if(!(t in this.settings))throw`Setting '${t}'' does not exist`;return this.settings[t]}isVsHuman(){const t=this.getSetting("ai_count");return this.getSetting("player_count")-t>1}isVsAI(){return this.getSetting("ai_count")>0}}class Z{constructor(t,e=null){this._gameState=t,this._callback=e,this._inFlight=!1,this._timeBetweenPoll=1e3,this._interval=null}async start(){const t=this;if(null==t._interval)return t._interval=setInterval(()=>{t._poll()},t._timeBetweenPoll),t._poll()}stop(){null!=this._interval&&(clearInterval(this._interval),this._interval=null)}async _poll(){if(this._inFlight)return;this._inFlight=!0;const t=this,e=t._gameState.timeUpdated,n="?updatedAfter="+e;return fetch(`/api/v1/game/${t._gameState.gameId}${n}`).then(e=>{if(t._inFlight=!1,200==e.status)return e.json();throw e.statusText}).then(n=>{e<n.game.time_updated&&(t._gameState.update(n.game),null!=this._callback&&this._callback())}).catch(()=>{t._inFlight=!1})}}function tt(t){let n,o,i,r;return{c(){n=h("button"),$(n,"type","button"),x(n,"background-color",et(t[3],t[4])),n.disabled=o=!t[5],$(n,"class","svelte-1spi4vf"),w(n,"outline",t[2]||t[1]||t[0]),w(n,"pulse",!t[1]&&!t[2]&&t[5]),w(n,"selected",t[0]&&!t[1]&&!t[2]&&t[5])},m(e,o){f(e,n,o),i||(r=y(n,"mouseup",t[6]),i=!0)},p(t,[e]){24&e&&x(n,"background-color",et(t[3],t[4])),32&e&&o!==(o=!t[5])&&(n.disabled=o),7&e&&w(n,"outline",t[2]||t[1]||t[0]),38&e&&w(n,"pulse",!t[1]&&!t[2]&&t[5]),39&e&&w(n,"selected",t[0]&&!t[1]&&!t[2]&&t[5])},i:e,o:e,d(t){t&&p(n),i=!1,r()}}}function et(t,e){return`rgba(${t[0]}, ${t[1]}, ${t[2]}, ${e})`}function nt(t,e,n){let o;const i=k(),r=[231,231,231],s=[240,255,0],l=[[0,0,0],[0,140,186],[244,67,54],[22,215,79],[255,195,0]];let{x:c}=e,{y:d}=e,{color:a=-1}=e,{pressures:u=[]}=e,{power:f=0}=e,{maxPower:p=4}=e,{selected:m=!1}=e,{allowMove:h=!0}=e,{pendingMove:g=!1}=e,{lastMove:v=!1}=e,y=r,$=1;return t.$$set=t=>{"x"in t&&n(7,c=t.x),"y"in t&&n(8,d=t.y),"color"in t&&n(9,a=t.color),"pressures"in t&&n(10,u=t.pressures),"power"in t&&n(11,f=t.power),"maxPower"in t&&n(12,p=t.maxPower),"selected"in t&&n(0,m=t.selected),"allowMove"in t&&n(13,h=t.allowMove),"pendingMove"in t&&n(1,g=t.pendingMove),"lastMove"in t&&n(2,v=t.lastMove)},t.$$.update=()=>{6659&t.$$.dirty&&(m||g?(n(3,y=s),n(4,$=1)):0<=a?(n(3,y=l[a]),n(4,$=0<f&&f<p?.75/p*f:1)):(n(3,y=r),n(4,$=1))),14336&t.$$.dirty&&n(5,o=h&&f<p)},[m,g,v,y,$,o,function(){i("selected",{x:c,y:d})},c,d,a,u,f,p,h]}class ot extends Q{constructor(t){var e;super(),document.getElementById("svelte-1spi4vf-style")||((e=h("style")).id="svelte-1spi4vf-style",e.textContent="button.svelte-1spi4vf,button.svelte-1spi4vf:disabled,button[disabled].svelte-1spi4vf{margin:1px;padding:0px;height:25px;width:25px;color:white;font:inherit;font-weight:bold;font-size:12px;text-align:center;border:1px solid black;outline:none}button.svelte-1spi4vf:active{box-shadow:inset 2px 2px 6px #c1c1c1}@keyframes svelte-1spi4vf-pulse{25%{transform:scale(1.1)}75%{transform:scale(0.9)}}.selected.svelte-1spi4vf,.pulse.svelte-1spi4vf:hover{animation-name:svelte-1spi4vf-pulse;animation-duration:1s;animation-timing-function:linear;animation-iteration-count:infinite}.outline.svelte-1spi4vf,.pulse.svelte-1spi4vf:hover{z-index:2;border:1px solid rgba(0, 0, 0, 0) !important;outline:3px solid black !important}",u(document.head,e)),K(this,t,nt,tt,l,{x:7,y:8,color:9,pressures:10,power:11,maxPower:12,selected:0,allowMove:13,pendingMove:1,lastMove:2})}}const{document:it}=X;function rt(t,e,n){const o=t.slice();return o[16]=e[n],o[18]=n,o}function st(t,e,n){const o=t.slice();return o[16]=e[n],o[20]=n,o}function lt(t){let e,o;const i=[{x:t[20]},{y:t[18]},{allowMove:t[0]},t[3][t[20]][t[18]],{selected:t[8]==t[20]&&t[9]==t[18]},{lastMove:at(t[10],t[20],t[18])},{pendingMove:t[8]==t[20]&&t[9]==t[18]&&t[7]}];let r={};for(let t=0;t<i.length;t+=1)r=n(r,i[t]);return e=new ot({props:r}),e.$on("selected",t[4]),{c(){q(e.$$.fragment)},m(t,n){D(e,t,n),o=!0},p(t,n){const o=1961&n?V(i,[i[0],i[1],1&n&&{allowMove:t[0]},8&n&&R(t[3][t[20]][t[18]]),768&n&&{selected:t[8]==t[20]&&t[9]==t[18]},1056&n&&{lastMove:at(t[10],t[20],t[18])},896&n&&{pendingMove:t[8]==t[20]&&t[9]==t[18]&&t[7]}]):{};e.$set(o)},i(t){o||(F(e.$$.fragment,t),o=!0)},o(t){U(e.$$.fragment,t),o=!1},d(t){G(e,t)}}}function ct(t){let e,n,o,i={length:t[1]},r=[];for(let e=0;e<i.length;e+=1)r[e]=lt(st(t,i,e));const s=t=>U(r[t],1,1,()=>{r[t]=null});return{c(){for(let t=0;t<r.length;t+=1)r[t].c();e=v(),n=h("br")},m(t,i){for(let e=0;e<r.length;e+=1)r[e].m(t,i);f(t,e,i),f(t,n,i),o=!0},p(t,n){if(1979&n){let o;for(i={length:t[1]},o=0;o<i.length;o+=1){const s=st(t,i,o);r[o]?(r[o].p(s,n),F(r[o],1)):(r[o]=lt(s),r[o].c(),F(r[o],1),r[o].m(e.parentNode,e))}for(N(),o=i.length;o<r.length;o+=1)s(o);Y()}},i(t){if(!o){for(let t=0;t<i.length;t+=1)F(r[t]);o=!0}},o(t){r=r.filter(Boolean);for(let t=0;t<r.length;t+=1)U(r[t]);o=!1},d(t){m(r,t),t&&p(e),t&&p(n)}}}function dt(t){let e,n,o={length:t[2]},i=[];for(let e=0;e<o.length;e+=1)i[e]=ct(rt(t,o,e));const r=t=>U(i[t],1,1,()=>{i[t]=null});return{c(){e=h("div");for(let t=0;t<i.length;t+=1)i[t].c();$(e,"class","container svelte-3bn73f"),x(e,"min-width",t[6]+"px")},m(t,o){f(t,e,o);for(let t=0;t<i.length;t+=1)i[t].m(e,null);n=!0},p(t,[s]){if(1983&s){let n;for(o={length:t[2]},n=0;n<o.length;n+=1){const r=rt(t,o,n);i[n]?(i[n].p(r,s),F(i[n],1)):(i[n]=ct(r),i[n].c(),F(i[n],1),i[n].m(e,null))}for(N(),n=o.length;n<i.length;n+=1)r(n);Y()}(!n||64&s)&&x(e,"min-width",t[6]+"px")},i(t){if(!n){for(let t=0;t<o.length;t+=1)F(i[t]);n=!0}},o(t){i=i.filter(Boolean);for(let t=0;t<i.length;t+=1)U(i[t]);n=!1},d(t){t&&p(e),m(i,t)}}}function at(t,e,n){for(let o of t)if(e==o[0]&&n==o[1])return!0;return!1}function ut(t,e,n){let o,i,r,s;const l=k();let c,{turnCompleted:d=0}=e,{width:a=0}=e,{height:u=0}=e,{spots:f=[]}=e,{allowMove:p=!0}=e,{moveHistory:m=[]}=e,{submittedSpotX:h=-1}=e,{submittedSpotY:g=-1}=e;return t.$$set=t=>{"turnCompleted"in t&&n(11,d=t.turnCompleted),"width"in t&&n(1,a=t.width),"height"in t&&n(2,u=t.height),"spots"in t&&n(3,f=t.spots),"allowMove"in t&&n(0,p=t.allowMove),"moveHistory"in t&&n(12,m=t.moveHistory),"submittedSpotX"in t&&n(13,h=t.submittedSpotX),"submittedSpotY"in t&&n(14,g=t.submittedSpotY)},t.$$.update=()=>{if(10240&t.$$.dirty&&n(8,o=h),18432&t.$$.dirty&&n(9,i=g),10240&t.$$.dirty&&n(7,c=-1===!h),4096&t.$$.dirty&&n(10,r=m.length>0?m.slice(-1)[0]:[]),2&t.$$.dirty&&n(6,s=26*a+75),66&t.$$.dirty){const t=document.getElementById("viewport");0<a&&s>screen.width&&t.setAttribute("content","width="+s)}},[p,a,u,f,function(t){const e=t.detail.x,r=t.detail.y;p&&(1!=window.CAPABILITY_TOUCH||o==e&&i==r?(n(7,c=!0),n(0,p=!1),n(8,o=e),n(9,i=r),l("move",{x:e,y:r})):(n(8,o=e),n(9,i=r)))},at,s,c,o,i,r,d,m,h,g]}class ft extends Q{constructor(t){var e;super(),it.getElementById("svelte-3bn73f-style")||((e=h("style")).id="svelte-3bn73f-style",e.textContent="div.container.svelte-3bn73f{line-height:1px}",u(it.head,e)),K(this,t,ut,dt,l,{turnCompleted:11,width:1,height:2,spots:3,allowMove:0,moveHistory:12,submittedSpotX:13,submittedSpotY:14,handleSpotSelected:4,isLastMove:5})}get handleSpotSelected(){return this.$$.ctx[4]}get isLastMove(){return at}}function pt(t){let e;return{c(){e=h("div"),e.innerHTML='<img src="/img/crown.png" width="35px" alt="Crown!"/>',$(e,"class","crown svelte-jyd0vx")},m(t,n){f(t,e,n)},d(t){t&&p(e)}}}function mt(t){let e,n,o,i,r,s,l,c;return{c(){e=h("div"),n=g(t[2]),o=v(),i=h("div"),r=g(t[4]),s=v(),l=h("div"),c=g(t[3])},m(t,d){f(t,e,d),u(e,n),f(t,o,d),f(t,i,d),u(i,r),f(t,s,d),f(t,l,d),u(l,c)},p(t,e){4&e&&b(n,t[2]),16&e&&b(r,t[4]),8&e&&b(c,t[3])},d(t){t&&p(e),t&&p(o),t&&p(i),t&&p(s),t&&p(l)}}}function ht(t){let n,o,i,r,s;return{c(){n=h("div"),n.textContent="Controlled",o=v(),i=h("div"),i.textContent="Projected",r=v(),s=h("div"),s.textContent="Pressuring"},m(t,e){f(t,n,e),f(t,o,e),f(t,i,e),f(t,r,e),f(t,s,e)},p:e,d(t){t&&p(n),t&&p(o),t&&p(i),t&&p(r),t&&p(s)}}}function gt(t){let n,o,i,r,s=t[5]&&pt();function l(t,e){return t[0]?ht:mt}let c=l(t),d=c(t);return{c(){n=h("div"),s&&s.c(),o=v(),i=h("div"),d.c(),$(i,"class",r="inner bg-color-"+t[1]+" svelte-jyd0vx"),w(i,"crown",t[5]),w(i,"key",t[0]),w(i,"player",!t[0]),$(n,"class","container svelte-jyd0vx")},m(t,e){f(t,n,e),s&&s.m(n,null),u(n,o),u(n,i),d.m(i,null)},p(t,[e]){t[5]?s||(s=pt(),s.c(),s.m(n,o)):s&&(s.d(1),s=null),c===(c=l(t))&&d?d.p(t,e):(d.d(1),d=c(t),d&&(d.c(),d.m(i,null))),2&e&&r!==(r="inner bg-color-"+t[1]+" svelte-jyd0vx")&&$(i,"class",r),34&e&&w(i,"crown",t[5]),3&e&&w(i,"key",t[0]),3&e&&w(i,"player",!t[0])},i:e,o:e,d(t){t&&p(n),s&&s.d(),d.d()}}}function vt(t,e,n){let o,{key:i=!1}=e,{color:r=0}=e,{gameOver:s=!1}=e,{winner:l=!1}=e,{controlled:c=0}=e,{pressuring:d=0}=e,{projected:a=0}=e;return t.$$set=t=>{"key"in t&&n(0,i=t.key),"color"in t&&n(1,r=t.color),"gameOver"in t&&n(6,s=t.gameOver),"winner"in t&&n(7,l=t.winner),"controlled"in t&&n(2,c=t.controlled),"pressuring"in t&&n(3,d=t.pressuring),"projected"in t&&n(4,a=t.projected)},t.$$.update=()=>{192&t.$$.dirty&&n(5,o=s&&l)},[i,r,c,d,a,o,s,l]}class yt extends Q{constructor(t){var e;super(),document.getElementById("svelte-jyd0vx-style")||((e=h("style")).id="svelte-jyd0vx-style",e.textContent="div.container.svelte-jyd0vx{display:inline-block}div.crown.svelte-jyd0vx{padding:0em 0em 0.2em 1.3em}div.inner.svelte-jyd0vx{padding:0.5em 1em 0.5em 1em;border:1px dashed black;text-align:center}div.key.svelte-jyd0vx{width:8em;border-radius:4px;color:black;font-weight:bolder}div.player.svelte-jyd0vx{width:4em;border-radius:4px;margin-left:0.5em;color:black;font-weight:bold}.bg-color-0.svelte-jyd0vx{background-color:rgba(0, 0, 0, 0.3)}.bg-color-1.svelte-jyd0vx{background-color:rgba(0, 140, 186, 0.35)}.bg-color-2.svelte-jyd0vx{background-color:rgba(244, 67, 54, 0.35)}.bg-color-3.svelte-jyd0vx{background-color:rgba(22, 215, 79, 0.35)}.bg-color-4.svelte-jyd0vx{background-color:rgba(255, 195, 0, 0.35)}@keyframes svelte-jyd0vx-crown{25%{transform:scale(1.05)}75%{transform:scale(1)}}.crown.svelte-jyd0vx{animation-name:svelte-jyd0vx-crown;animation-duration:2s;animation-timing-function:linear;animation-iteration-count:infinite}",u(document.head,e)),K(this,t,vt,gt,l,{key:0,color:1,gameOver:6,winner:7,controlled:2,pressuring:3,projected:4})}}function $t(t,e,n){const o=t.slice();return o[4]=e[n],o[6]=n,o}function bt(t){let e;function n(t,e){return t[2]?wt:xt}let o=n(t),i=o(t);return{c(){e=h("div"),i.c(),$(e,"class","gameover svelte-n38d5k")},m(t,n){f(t,e,n),i.m(e,null)},p(t,r){o!==(o=n(t))&&(i.d(1),i=o(t),i&&(i.c(),i.m(e,null)))},d(t){t&&p(e),i.d()}}}function xt(t){let e;return{c(){e=h("p"),e.textContent="This game has ended!",$(e,"class","svelte-n38d5k")},m(t,n){f(t,e,n)},d(t){t&&p(e)}}}function wt(t){let e;return{c(){e=h("p"),e.textContent="This game has ended in a tie!",$(e,"class","svelte-n38d5k")},m(t,n){f(t,e,n)},d(t){t&&p(e)}}}function _t(t){let e,o;const i=[{color:t[6]},{gameOver:t[0]},{winner:Ct(t[6],t[1])},t[4]];let r={};for(let t=0;t<i.length;t+=1)r=n(r,i[t]);return e=new yt({props:r}),{c(){q(e.$$.fragment)},m(t,n){D(e,t,n),o=!0},p(t,n){const o=3&n?V(i,[i[0],1&n&&{gameOver:t[0]},2&n&&{winner:Ct(t[6],t[1])},2&n&&R(t[4])]):{};e.$set(o)},i(t){o||(F(e.$$.fragment,t),o=!0)},o(t){U(e.$$.fragment,t),o=!1},d(t){G(e,t)}}}function kt(t){let e,n,o,i,r,s,l=t[0]&&bt(t);i=new yt({props:{key:!0}});let c=t[1],d=[];for(let e=0;e<c.length;e+=1)d[e]=_t($t(t,c,e));const a=t=>U(d[t],1,1,()=>{d[t]=null});return{c(){e=h("div"),l&&l.c(),n=v(),o=h("div"),q(i.$$.fragment),r=v();for(let t=0;t<d.length;t+=1)d[t].c();$(o,"class","container svelte-n38d5k")},m(t,c){f(t,e,c),l&&l.m(e,null),u(e,n),u(e,o),D(i,o,null),u(o,r);for(let t=0;t<d.length;t+=1)d[t].m(o,null);s=!0},p(t,[i]){if(t[0]?l?l.p(t,i):(l=bt(t),l.c(),l.m(e,n)):l&&(l.d(1),l=null),3&i){let e;for(c=t[1],e=0;e<c.length;e+=1){const n=$t(t,c,e);d[e]?(d[e].p(n,i),F(d[e],1)):(d[e]=_t(n),d[e].c(),F(d[e],1),d[e].m(o,null))}for(N(),e=c.length;e<d.length;e+=1)a(e);Y()}},i(t){if(!s){F(i.$$.fragment,t);for(let t=0;t<c.length;t+=1)F(d[t]);s=!0}},o(t){U(i.$$.fragment,t),d=d.filter(Boolean);for(let t=0;t<d.length;t+=1)U(d[t]);s=!1},d(t){t&&p(e),l&&l.d(),G(i),m(d,t)}}}function Ct(t,e){let n=!0;const o=e[t].controlled;for(let i=0;i<e.length;i++)if(i!=t&&e[i].controlled>=o){n=!1;break}return n}function jt(t,e,n){let o,{gameOver:i=!1}=e,{scores:r=[]}=e,{leaders:s=[]}=e;return t.$$set=t=>{"gameOver"in t&&n(0,i=t.gameOver),"scores"in t&&n(1,r=t.scores),"leaders"in t&&n(3,s=t.leaders)},t.$$.update=()=>{9&t.$$.dirty&&n(2,o=i&&s.length>0)},[i,r,o,s]}class Mt extends Q{constructor(t){var e;super(),document.getElementById("svelte-n38d5k-style")||((e=h("style")).id="svelte-n38d5k-style",e.textContent="p.svelte-n38d5k{padding:8px}div.container.svelte-n38d5k{white-space:nowrap}div.gameover.svelte-n38d5k{width:535px;border-radius:5px;color:white;background-color:rgba(255, 0, 0, 0.6);font-weight:bold}",u(document.head,e)),K(this,t,jt,kt,l,{gameOver:0,scores:1,leaders:3})}}function St(t){let n,o,i,r,s;return{c(){n=h("div"),o=h("input"),i=g("\n  See projected board"),$(o,"type","checkbox")},m(e,l){f(e,n,l),u(n,o),u(n,i),r||(s=y(o,"change",t[0]),r=!0)},p:e,i:e,o:e,d(t){t&&p(n),r=!1,s()}}}function It(t){return[function(e){C.call(this,t,e)}]}class zt extends Q{constructor(t){super(),K(this,t,It,St,l,{})}}const{document:Et}=X;function Ht(t){let n;return{c(){n=h("p"),n.textContent="The game will start when you make your first move.",$(n,"class","svelte-1pfd73t")},m(t,e){f(t,n,e)},p:e,d(t){t&&p(n)}}}function Ot(t){let e,n,o,i,r,s,l;return{c(){e=h("p"),e.textContent="The game will start after all players have made their first move. To\n      invite a friend to the game, share the following link:",n=v(),o=h("p"),i=h("span"),r=g(t[1]),$(e,"class","svelte-1pfd73t"),$(i,"id","share-url"),$(i,"class","svelte-1pfd73t"),$(o,"class","share svelte-1pfd73t")},m(t,c){f(t,e,c),f(t,n,c),f(t,o,c),u(o,i),u(i,r),s||(l=y(o,"mouseup",Bt),s=!0)},p(t,e){2&e&&b(r,t[1])},d(t){t&&p(e),t&&p(n),t&&p(o),s=!1,l()}}}function Pt(t){let n;function o(t,e){return t[0]?Ot:Ht}let i=o(t),r=i(t);return{c(){n=h("div"),r.c(),$(n,"class","svelte-1pfd73t")},m(t,e){f(t,n,e),r.m(n,null)},p(t,[e]){i===(i=o(t))&&r?r.p(t,e):(r.d(1),r=i(t),r&&(r.c(),r.m(n,null)))},i:e,o:e,d(t){t&&p(n),r.d()}}}function Bt(){const t=document.getElementById("share-url"),e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e),document.execCommand("copy")}function Tt(t,e,n){let o,{gameId:i=0}=e,{vsHumans:r=!1}=e;return t.$$set=t=>{"gameId"in t&&n(2,i=t.gameId),"vsHumans"in t&&n(0,r=t.vsHumans)},t.$$.update=()=>{4&t.$$.dirty&&n(1,o=`${window.location.protocol}//${window.location.host}/game/${i}`)},[r,o,i]}class At extends Q{constructor(t){var e;super(),Et.getElementById("svelte-1pfd73t-style")||((e=h("style")).id="svelte-1pfd73t-style",e.textContent="div.svelte-1pfd73t.svelte-1pfd73t{width:535px;border-radius:5px;color:white;background-color:rgba(255, 0, 0, 0.6);font-weight:bold}p.svelte-1pfd73t.svelte-1pfd73t{padding:8px;margin-bottom:0px}p.share.svelte-1pfd73t.svelte-1pfd73t{margin-top:2px;color:yellow}p.share.svelte-1pfd73t span.svelte-1pfd73t{padding:4px;border-radius:5px;border-color:black;border-style:dashed}",u(Et.head,e)),K(this,t,Tt,Pt,l,{gameId:2,vsHumans:0})}}function Lt(t){let n;return{c(){n=h("p"),n.textContent="Loading..."},m(t,e){f(t,n,e)},p:e,i:e,o:e,d(t){t&&p(n)}}}function Nt(t){let e,n,o,i,r,s,l,c,d;const a=[Ft,Yt],m=[];function g(t,e){return 0==t[5]?0:1}e=g(t),n=m[e]=a[e](t),r=new zt({}),r.$on("change",t[10]);let y=t[8]&&Ut();return c=new ft({props:{height:t[0].getSetting("dimension_x"),width:t[0].getSetting("dimension_y"),moveHistory:t[0].moveHistory,allowMove:t[6],spots:t[7],turnCompleted:t[5],submittedSpotX:t[1],submittedSpotY:t[3]}}),c.$on("move",t[9]),{c(){n.c(),o=v(),i=h("div"),q(r.$$.fragment),s=v(),y&&y.c(),l=v(),q(c.$$.fragment),$(i,"class","board-header svelte-18c85dd")},m(t,n){m[e].m(t,n),f(t,o,n),f(t,i,n),D(r,i,null),u(i,s),y&&y.m(i,null),f(t,l,n),D(c,t,n),d=!0},p(t,r){let s=e;e=g(t),e===s?m[e].p(t,r):(N(),U(m[s],1,1,()=>{m[s]=null}),Y(),n=m[e],n?n.p(t,r):(n=m[e]=a[e](t),n.c()),F(n,1),n.m(o.parentNode,o)),t[8]?y||(y=Ut(),y.c(),y.m(i,null)):y&&(y.d(1),y=null);const l={};1&r&&(l.height=t[0].getSetting("dimension_x")),1&r&&(l.width=t[0].getSetting("dimension_y")),1&r&&(l.moveHistory=t[0].moveHistory),64&r&&(l.allowMove=t[6]),128&r&&(l.spots=t[7]),32&r&&(l.turnCompleted=t[5]),2&r&&(l.submittedSpotX=t[1]),8&r&&(l.submittedSpotY=t[3]),c.$set(l)},i(t){d||(F(n),F(r.$$.fragment,t),F(c.$$.fragment,t),d=!0)},o(t){U(n),U(r.$$.fragment,t),U(c.$$.fragment,t),d=!1},d(t){m[e].d(t),t&&p(o),t&&p(i),G(r),y&&y.d(),t&&p(l),G(c,t)}}}function Yt(t){let e,n;return e=new Mt({props:{gameOver:t[2],scores:t[0].scores}}),{c(){q(e.$$.fragment)},m(t,o){D(e,t,o),n=!0},p(t,n){const o={};4&n&&(o.gameOver=t[2]),1&n&&(o.scores=t[0].scores),e.$set(o)},i(t){n||(F(e.$$.fragment,t),n=!0)},o(t){U(e.$$.fragment,t),n=!1},d(t){G(e,t)}}}function Ft(t){let e,n;return e=new At({props:{gameId:t[0].gameId,vsHumans:t[0].isVsHuman()}}),{c(){q(e.$$.fragment)},m(t,o){D(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.gameId=t[0].gameId),1&n&&(o.vsHumans=t[0].isVsHuman()),e.$set(o)},i(t){n||(F(e.$$.fragment,t),n=!0)},o(t){U(e.$$.fragment,t),n=!1},d(t){G(e,t)}}}function Ut(t){let e;return{c(){e=h("div"),e.textContent="Opponent is ready",$(e,"class","opponent-status svelte-18c85dd")},m(t,n){f(t,e,n)},d(t){t&&p(e)}}}function Xt(t){let e,n,o,i;const r=[Nt,Lt],s=[];function l(t,e){return t[4]?0:1}return e=l(t),n=s[e]=r[e](t),{c(){n.c(),o=g("")},m(t,n){s[e].m(t,n),f(t,o,n),i=!0},p(t,[i]){let c=e;e=l(t),e===c?s[e].p(t,i):(N(),U(s[c],1,1,()=>{s[c]=null}),Y(),n=s[e],n?n.p(t,i):(n=s[e]=r[e](t),n.c()),F(n,1),n.m(o.parentNode,o))},i(t){i||(F(n),i=!0)},o(t){U(n),i=!1},d(t){s[e].d(t),t&&p(o)}}}function Vt(t,e,n){let o,i,r,s,l,c,d,a,{gameId:u=0}=e,f=new W(u);return new Z(f,()=>{n(0,f),f.turnMoves&&function(){n(1,d=void 0),n(3,a=void 0);const t=f.turnMoves[f.playerId];if(!t)return;n(1,d=t[0]),n(3,a=t[1])}()}).start(),t.$$set=t=>{"gameId"in t&&n(11,u=t.gameId)},t.$$.update=()=>{1&t.$$.dirty&&n(4,o=f.init),1&t.$$.dirty&&n(2,i=f.completed),1&t.$$.dirty&&n(5,r=f.turnCompleted),7&t.$$.dirty&&n(6,s=!d&&!i&&f.timeStarted>0),1&t.$$.dirty&&n(7,l=f.spotsCurrent),1&t.$$.dirty&&n(8,c=f.turnMoves[f.playerId]?Object.keys(f.turnMoves).length>=2:Object.keys(f.turnMoves).length>=1)},[f,d,i,a,o,r,s,l,c,function(t){const e=t.detail.x,o=t.detail.y;n(6,s=!1),fetch(`/api/v1/game/${u}/move/${e}/${o}`)},function(t){t.target.checked?(n(6,s=!1),n(7,l=f.spotsProjected)):(n(6,s=!0),n(7,l=f.spotsCurrent))},u]}async function Rt(t,e,n){const o={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({player_count:t,ai_count:e,ai_strength:n})};return fetch("/api/v1/game/new",o).then(t=>{if(200==t.status)return t.json();throw t.statusText}).then(t=>{const e=t.game.game_id;window.location.assign("/game/"+e)}).catch(()=>{})}function qt(t,e,n){const o=t.slice();return o[6]=e[n],o}function Dt(t){let e,n,o,i,r,s,l=t[6][0]+"";return{c(){e=h("button"),n=g(l),o=v(),$(e,"class","button-difficulty svelte-1czfe8e"),$(e,"difficulty",i=t[6][1]),w(e,"button-difficulty-selected",t[0]==t[6][1])},m(i,l){f(i,e,l),u(e,n),u(e,o),r||(s=y(e,"mouseup",t[4]),r=!0)},p(t,n){3&n&&w(e,"button-difficulty-selected",t[0]==t[6][1])},d(t){t&&p(e),r=!1,s()}}}function Gt(t){let n,o,i,s,l,c,d,a,g,b,x,w,_,k,C=t[1],j=[];for(let e=0;e<C.length;e+=1)j[e]=Dt(qt(t,C,e));return{c(){n=h("div"),o=h("div"),o.innerHTML='<img src="/img/intro.gif" alt="Demo gif"/>',i=v(),s=h("div"),l=h("div"),c=h("div"),d=h("button"),d.textContent="Play AI",a=v(),g=h("div");for(let t=0;t<j.length;t+=1)j[t].c();b=v(),x=h("div"),w=h("button"),w.textContent="Play Friend",$(o,"class","block svelte-1czfe8e"),$(d,"class","button-play button-ai svelte-1czfe8e"),$(g,"class","difficulty svelte-1czfe8e"),$(l,"class","option-ai svelte-1czfe8e"),$(w,"class","button-play button-friend svelte-1czfe8e"),$(x,"class","option-friend svelte-1czfe8e"),$(s,"class","block svelte-1czfe8e"),$(n,"class","container svelte-1czfe8e")},m(e,r){f(e,n,r),u(n,o),u(n,i),u(n,s),u(s,l),u(l,c),u(c,d),u(l,a),u(l,g);for(let t=0;t<j.length;t+=1)j[t].m(g,null);u(s,b),u(s,x),u(x,w),_||(k=[y(d,"mouseup",t[2]),y(w,"mouseup",t[3])],_=!0)},p(t,[e]){if(19&e){let n;for(C=t[1],n=0;n<C.length;n+=1){const o=qt(t,C,n);j[n]?j[n].p(o,e):(j[n]=Dt(o),j[n].c(),j[n].m(g,null))}for(;n<j.length;n+=1)j[n].d(1);j.length=C.length}},i:e,o:e,d(t){t&&p(n),m(j,t),_=!1,r(k)}}}function Jt(t,e,n){let o=0,i=0;return[i,[["Easy",0],["Medium",1],["Hard",2]],function(){o=1,Rt(2,o,i)},function(){Rt(2,o,i)},function(t){n(0,i=t.target.getAttribute("difficulty"))}]}return t.Game=class extends Q{constructor(t){var e;super(),document.getElementById("svelte-18c85dd-style")||((e=h("style")).id="svelte-18c85dd-style",e.textContent=".board-header.svelte-18c85dd{margin-top:1rem;display:flex;align-items:center}.opponent-status.svelte-18c85dd{margin-left:2rem;font-size:0.9rem;color:rgba(0, 0, 0, 0.5)}",u(document.head,e)),K(this,t,Vt,Xt,l,{gameId:11})}},t.Menu=class extends Q{constructor(t){var e;super(),document.getElementById("svelte-1czfe8e-style")||((e=h("style")).id="svelte-1czfe8e-style",e.textContent=".container.svelte-1czfe8e{display:inline-flex;flex-wrap:wrap}.block.svelte-1czfe8e{margin-right:1em}.option-ai.svelte-1czfe8e{margin-top:5%}.option-friend.svelte-1czfe8e{margin-top:8%}button.svelte-1czfe8e{cursor:pointer}.button-play.svelte-1czfe8e{border-radius:4px;color:white;font-size:300%;text-shadow:0 1px 1px rgba(0, 0, 0, 0.2)}.button-ai.svelte-1czfe8e{background:rgb(223, 117, 20)}.button-friend.svelte-1czfe8e{background:rgb(28, 184, 65)}div.difficulty.svelte-1czfe8e{margin-top:0.5em}.button-difficulty.svelte-1czfe8e{color:white;margin-right:0.5em;font-size:125%;text-shadow:0 1px 1px rgba(0, 0, 0, 0.2);background:rgb(223, 117, 20)}.button-difficulty-selected.svelte-1czfe8e{outline:3px dashed black;outline-offset:3px}",u(document.head,e)),K(this,t,Jt,Gt,l,{})}},t.detectCapabilities=function(){window.addEventListener("touchstart",(function t(){window.CAPABILITY_TOUCH=!0,window.removeEventListener("touchstart",t,!1)}),!1)},Object.defineProperty(t,"__esModule",{value:!0}),t}({});
//# sourceMappingURL=ui.js.map
